/*
 quizwebapp 2016-12-15 
*/
!function(){function a(a,b){a.state("/",{url:"/",templateUrl:"html/homeView.html",controller:"homeController",controllerAs:"homeCtrl"}).state("home",{url:"/home",templateUrl:"html/homeView.html",controller:"homeController",controllerAs:"homeCtrl"}).state("login",{url:"/login",templateUrl:"html/login.html",controller:"authController",controllerAs:"authCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()&&a.go("home")}]}).state("registreer",{url:"/registreer",templateUrl:"html/register.html",controller:"authController",controllerAs:"authCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()&&a.go("home")}]}).state("profiel",{url:"/profiel",templateUrl:"html/profiel.html",controller:"profielController",controllerAs:"profielCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("scorebord",{url:"/scorebord",templateUrl:"html/score.html",controller:"scoreController",controllerAs:"scoreCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("contact",{url:"/contact",templateUrl:"html/contactView.html",controller:"homeController",controllerAs:"homeCtrl"}).state("about",{url:"/about",templateUrl:"html/aboutView.html",controller:"homeController",controllerAs:"homeCtrl"}).state("spelenReeks",{url:"/spelen/reeks",templateUrl:"html/spelReeksConfig.html",controller:"spelController",controllerAs:"spelCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("spelenReeksId",{url:"/spelen/reeks/:id",templateUrl:"html/spel.html",controller:"reeksController",controllerAs:"reeksCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("spelenQuiz",{url:"/spelen/quiz",templateUrl:"html/quizConfig.html",controller:"quizController",controllerAs:"quizCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("SpelenQuizId",{url:"/spelen/quiz/:id",templateUrl:"html/spel.html",controller:"quizController",controllerAs:"quizCtrl",onEnter:["$state","authFactory",function(a,b){b.isLoggedIn()||a.go("login")}]}).state("landen",{url:"/landen",templateUrl:"html/landen.html",controller:"landenController",controllerAs:"landenCtrl"}),b.otherwise("home")}angular.module("quizApp",["ui.router","ngAnimate"]).config(a),a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){angular.module("quizApp").constant("GLOBALS",{alleLandenURL:"https://landenquizapp.herokuapp.com/api/landen",reeksURL:"https://landenquizapp.herokuapp.com/api/reeks/",loginUrl:"https://landenquizapp.herokuapp.com/api/login",registreerUrl:"https://landenquizapp.herokuapp.com/api/registreer",quizUrl:"https://landenquizapp.herokuapp.com/api/quiz/",usernamesUrl:"https://landenquizapp.herokuapp.com/api/names",userUrl:"https://landenquizapp.herokuapp.com/api/user",highscoreURL:"https://landenquizapp.herokuapp.com/api/highscore",updateScoreURL:"https://landenquizapp.herokuapp.com/api/score/"})}(),function(){function a(a,b,c){var d=this;a.user={},d.warning=!1,d.emptyWarning=!1,a.error=!1,a.register=function(){if(""==a.user.username||"undefined"==typeof a.user.username)d.emptyWarning=!0;else if(""==a.user.password||"undefined"==typeof a.user.password)d.emptyWarning=!0;else{var e=/^[0-9a-zA-Z]+$/,f=a.user.username.match(e),g=a.user.password.match(e);f&&g?c.register(a.user).error(function(b){a.error=!0}).then(function(){b.go("home")}):(a.user.username="",a.user.password="",d.warning=!0)}},a.logIn=function(){""==a.user.username||"undefined"==typeof a.user.username?d.emptyWarning=!0:""==a.user.password||"undefined"==typeof a.user.password?d.emptyWarning=!0:a.user.username&&a.user.password?(d.emptyWarning=!1,c.logIn(a.user).error(function(b){a.error=!0}).then(function(){b.go("home")})):d.emptyWarning=!0}}function b(a,b){a.isLoggedIn=b.isLoggedIn,a.currentUser=b.currentUser,a.logOut=b.logOut}function c(a,b,c){var d=this;d.toScore=function(){b.go("scorebord")},d.toProfiel=function(){b.go("profiel")},d.onSpelen=function(){b.go("spelen")},d.onSpeelReeks=function(){b.go("spelenReeks")},d.onSpeelQuiz=function(){b.go("spelenQuiz")}}function d(a,b){var c=this;c.landen={},b.getAlleLanden(a).then(function(a,b){b&&console.log(b),c.landen=a,c.land=a[0]})}function e(a,b,c){var d=this;d.keuzes=[{id:5,tekst:"5"},{id:10,tekst:"10"}],a.selectedOption=d.keuzes[0],d.keuze=a.selectedOption.id}function f(a,b,c,d){var e=this;a.isQuiz=!0,a.showForm=!0,a.showResult=!1,e.quizes=[],e.tag={},b.geefQuizes().then(function(a,b){if(b&&console.log(b),e.quizes=a,"undefined"!=typeof d.id){var c=a[d.id-1];e.quiz=c.landen}}),e.startQuiz=function(a){e.tag=a,c.path("/spelen/quiz/"+a)},e.controleer=function(){a.uitslag={},a.uitslag.juist=0,a.uitslag.fout=0;for(var c=0;c<e.quiz.length;c++)e.quiz[c].keuze.toLowerCase()!==e.quiz[c].hoofdstad.toLowerCase()?a.uitslag.fout+=1:a.uitslag.juist+=1;b.updateScoreQuiz(a.uitslag.juist),a.showForm=!1,a.showResult=!0},e.reset=function(){e.quiz=[],a.showForm=!0,a.showResult=!1,b.geefQuizes().then(function(a,b){if(b&&console.log(b),e.quizes=a,null!==d.id||"undefined"!=typeof d.id){var c=a[d.id-1];e.quiz=c.landen}})},e.nieuwSpel=function(){e.reset(),c.path("/spelen/quiz/"+d.id)}}function g(a,b,c,d,e){var f=this;a.isReeks=!0,f.aantal=c.id,a.reeks=[],f.opties=[],a.showForm=!0,a.showResult=!1,d.geefReeks(e,f.aantal).then(function(b,c){c&&console.log(c),f.reeks=b;for(var d=0;d<a.aantal;d++)f.opties[d]=b[d].options}),f.reset=function(){f.opties=[],f.reeks=[],a.showForm=!0,a.showResult=!1,d.geefReeks(e,f.aantal).then(function(a,b){b&&console.log(b),f.reeks=a;for(var c=0;c<f.aantal;c++)f.opties[c]=a[c].options})},f.controleer=function(){a.uitslag={},a.uitslag.juist=0,a.uitslag.fout=0;for(var b=0;b<f.reeks.length;b++)f.reeks[b].keuze.toLowerCase()!==f.reeks[b].hoofdstad.toLowerCase()?a.uitslag.fout+=1:a.uitslag.juist+=1;d.updateScoreReeks(e,a.uitslag.juist),a.showForm=!1,a.showResult=!0},f.nieuwSpel=function(){f.reset(e,f.aantal),b.path("/spelen/reeks/"+f.aantal)},f.reeksCfg=function(){b.path("/spelen/")}}function h(a,b){b.getHighScores().then(function(b,c){c&&console.log(c),a.scores=b.data})}function i(a,b,c){b.getGebruiker().then(function(b,d){d&&console.log(d),a.user=c.currentUser(),a.playedQ=b.data.aantalGespeeldQ,a.playedR=b.data.aantalGespeeldR,a.score=b.data.score})}angular.module("quizApp").controller("homeController",c).controller("profielController",i).controller("scoreController",h).controller("quizController",f).controller("navController",b).controller("authController",a).controller("landenController",d).controller("spelController",e).controller("reeksController",g),a.$inject=["$scope","$state","authFactory"],b.$inject=["$scope","authFactory"],c.$inject=["$scope","$state","authFactory"],d.$inject=["GLOBALS","landenService"],e.$inject=["$scope","$location","reeksService"],f.$inject=["$scope","quizService","$location","$stateParams"],g.$inject=["$scope","$location","$stateParams","reeksService","GLOBALS","landenService"],h.$inject=["$scope","gebruikerService"],i.$inject=["$scope","gebruikerService","authFactory"]}(),function(){function a(){return{template:'<div class="fade-in-out alert alert-danger directiveWarning">Enkel cijfers en letters zijn toegelaten als gebruikersnaam en paswoord!</div>',replace:"true",restrict:"AE"}}function b(a){return{require:"ngModel",link:function(b,c,d,e){b.myForm.$invalid=!1,e.$asyncValidators.username=function(c,d){return a.checkNaam(d).then(function(a){"nok"==a.data.response?b.myForm.username.$error=!0:b.myForm.username.$error=!1})}}}}angular.module("quizApp").directive("wrongInput",a).directive("checkUserNameAsync",b),b.$inject=["gebruikerService"]}(),function(){function a(a,b,c){var d={};return d.saveToken=function(a){b.localStorage.quizapptoken=a},d.getToken=function(){return b.localStorage.quizapptoken},d.isLoggedIn=function(){var a=d.getToken();if(a){var c=JSON.parse(b.atob(a.split(".")[1]));return c.exp>Date.now()/1e3}return!1},d.currentUser=function(){if(d.isLoggedIn()){var a=d.getToken(),c=JSON.parse(b.atob(a.split(".")[1]));return c.username}},d.register=function(b){return a.post(c.registreerUrl,b).success(function(a){d.saveToken(a.token)})},d.logIn=function(b){return a.post(c.loginUrl,b).success(function(a){d.saveToken(a.token)})},d.logOut=function(){b.localStorage.removeItem("quizapptoken")},d}angular.module("quizApp").factory("authFactory",a),a.$inject=["$http","$window","GLOBALS"]}(),function(){function a(a,b,c,d){var e={};return e.getGebruiker=function(){var e=b.defer();return a.post(c.userUrl,null,{headers:{Authorization:"Bearer "+d.getToken()}}).success(function(a){e.resolve(a)})},e.getHighScores=function(){var e=b.defer();return a.post(c.highscoreURL,null,{headers:{Authorization:"Bearer "+d.getToken()}}).success(function(a){e.resolve(a)})},e.getGebruikerNamen=function(){var d=b.defer();return a.get(c.usernamesUrl).success(function(a){d.resolve(a)})},e.checkNaam=function(d){var e=b.defer(),f={};return f.naam=d,a.post(c.usernamesUrl,f).success(function(a){e.resolve(a)})},e}function b(a,b){var c={};return c.getAlleLanden=function(c){var d=b.defer();return a({url:c.alleLandenURL,method:"GET"}).success(function(a){d.resolve(a)}),d.promise},c}function c(a,b,c){var d={};return d.temp={},d.geefReeks=function(c,d){var e=b.defer();return a({url:c.reeksURL+d,method:"GET"}).success(function(a){e.resolve(a)}),e.promise},d.updateScoreReeks=function(d,e){var f=b.defer(),g={};return g.score=e,a.post(d.updateScoreURL+"reeks",g,{headers:{Authorization:"Bearer "+c.getToken()}}).success(function(a){f.resolve(a)}),f.promise},d}function d(a,b,c,d){var e={};return e.temp={},e.geefQuizes=function(){var d=b.defer();return a({url:c.quizUrl,method:"GET"}).success(function(a){d.resolve(a)}),d.promise},e.geefQuiz=function(b){return a({url:c.quizUrl+b,method:"GET"}).success(function(a){deferred.resolve(a)}),deferred.promise},e.updateScoreQuiz=function(e){var f=b.defer(),g={};return g.score=e,a.post(c.updateScoreURL+"quiz",g,{headers:{Authorization:"Bearer "+d.getToken()}}).success(function(a){f.resolve(a)}),f.promise},e}angular.module("quizApp").service("gebruikerService",a).service("landenService",b).service("quizService",d).service("reeksService",c),a.$inject=["$http","$q","GLOBALS","authFactory"],b.$inject=["$http","$q"],c.$inject=["$http","$q","authFactory"],d.$inject=["$http","$q","GLOBALS","authFactory"]}();